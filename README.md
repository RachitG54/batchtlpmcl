# Time-Lock Puzzles with Efficient Batch Solving

This is an implementation of our paper "Time-Lock Puzzles with Efficient Batch Solving".

[comment]: # (add eprint link when uploaded https://eprint.iacr.org/2023/)

> **WARNING**: This is research-quality code; it has not been checked for side-channel leakage or basic logical or memory safety issues. Do not use this in production.

We thank the authors of libhtlp (https://github.com/verifiable-timed-signatures/liblhtlp). Their code was used for the implementation of time lock puzzles from the paper (https://eprint.iacr.org/2019/635.pdf) - Section 4.1

Our code is organized into multiple folders, the src folder contains the different code files, the puzzle folder contains the RSA keys. We haven't included code to serialize the puzzle and the public paramters for our key homomorphic PRF.

## Building

To build, you will need:
- A modern C++ compiler
- mcl (https://github.com/herumi/mcl/)
- `gcc v9.2.1`
- `gmp v6.2.0-1`


Uncomment the respective functions below in testlibs.cpp to test, set parameters and run experiments respectively.
## Testing
To test, the libraries, run the testrepo function in testlibs.cpp


## Parameters
The parameters used in our system are generated by the matchparams function. To generate your own parameters, run `./testlibs 10` to set the parameters for 10 users and 40 bits of statistical secuirty. The parameters will be output into 'puzzles/params.csv' file.


## Experiments
For the experiments below, arr_right contains the parameter values print encoded from running the previous commands.

To replicate the key table from the paper for the trivial solution run:

```
./script.sh
```
To replicate the key tables from the paper for our proposed solution, run:

```
./script2.sh
```